---
title: "Covid 19"
author: "Anjolie"
date: "3/17/2021"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(digits=2)
require(tidyverse)
require(tigerstats)
require(lubridate)
require(dplyr)
require(ggplot2)
kRdata <- read_csv("kRdata.csv", col_types = cols(sex = col_skip(), Sex = col_factor(levels = c("M", "F")), result = col_factor(levels = c("alive", "dead"))))

kRdata$age <- as.factor(kRdata$age) 
kRdata$infection_case <- as.factor(kRdata$infection_case)
```
### Data is from the Patient_Info dataset from South Korea 1 Jan to 1 May 
### This is contained in a downloadable zip file from kaggle

Some of the data was uncoded for sex - sex must be just male or female
77 of the data entries were coded sex  as blank, so we omit these.
state of a patient must be died or alive - we adjust that as well  

We are using Cat~Cat to do variable analysis, since both "Sex" and "result" are categorical (or factor) variables with "M" & "F" and "alive" & "dead" possibilities respectively. We will compare both the percentage and count results (in graphical and numerical form) of all 4 combinations of these variables (as they can form a 2 by 2 table). This table will also be used to do the chi- square and fischer inferential tests to ensure the findings are actually significant (and not up to chance).  
We will also be considering age, for thoroughness; comparing age and result makes an 11 by 2 table, but that data will stil be usable.  
  
# Question 1 - Is dying independent of sex

$H_A$: Dying is affected by sex. 
$H_0$: Dying is independent of sex. 

Table of patients:
```{r}

# cross tabulation, patient state by gender

with(kRdata, table(Sex, result))
with(kRdata, table(age, result))
```

## We create two bar charts - one based on frequency and the other on percent, use ggplot commands to do this

```{r}
#result vs Sex
sexResult <- kRdata %>%
group_by(result,Sex) %>%
summarize(count=n()) %>% 
mutate(prcnt=count/sum(count))

basicC <- ggplot(sexResult,aes(x=result,y=count,fill=Sex))
basicC + geom_bar(stat="identity",position="dodge")

basicCC <- ggplot(sexResult,aes(x=result,y=prcnt*100,fill=Sex)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```  
  
Most of the participants survived, but females survived more often than males.  
```{r}
#result vs age
ageResult <- kRdata %>%
group_by(result,age) %>%
summarize(count=n()) %>% 
mutate(prcnt=count/sum(count))

basicC <- ggplot(ageResult,aes(x=result,y=count,fill=age))
basicC + geom_bar(stat="identity",position="dodge")

basicCC <- ggplot(ageResult,aes(x=result,y=prcnt*100,fill=age)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```
  
Out of those who survived, those in their 20s to 50s are more common; of those who died, those in their 60s to 90s are more common; those who died were always in their 30s or older. Thus, it can be assumed that older people are more likely to die.  
```{r}
#Sex vs age
sexAge <- kRdata %>%
group_by(Sex,age) %>%
summarize(count=n()) %>% 
mutate(prcnt=count/sum(count))

basicC <- ggplot(sexAge,aes(x=Sex,y=count,fill=age))
basicC + geom_bar(stat="identity",position="dodge")

basicCC <- ggplot(sexAge,aes(x=Sex,y=prcnt*100,fill=age)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```
  
The females in this sample appear to have been slightly older, disproving my theory that the "Sex vs result" findings were due to males being older. Not significant enough for a chi- squared or Tukey test, though.  
## Numerical results
```{r}
table1 <- xtabs(~result + Sex, data=kRdata)
rowPerc(table1)
colPerc(table1)
```
  
]]
```{r}
table2 <- xtabs(~result + age, data=kRdata)
rowPerc(table2)
colPerc(table2)
```  
  
]]
```{r}
table3 <- xtabs(~age + Sex, data=kRdata)
rowPerc(table3)
colPerc(table3)
```  
  
]]
## Inferential results 




## Conclusions

